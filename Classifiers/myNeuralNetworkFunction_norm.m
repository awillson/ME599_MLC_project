function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 31-May-2017 12:30:29.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx80 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1;-1];
x1_step1.gain = [1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.497595862680260792;1.8720500919319944533;-0.43449734220422453479;0.41522250978318170356;-0.056822069380012843465;-0.12759254740303646591;-0.40541595546047692888;0.71502594512864992016;1.032252220058702985;-1.1993418465081566726];
IW1_1 = [-0.15821848294766152621 0.19866907050578291871 0.059972606150713182738 -0.22388619999822956252 -0.3268726391248366614 0.17352853525451503169 0.027880019264948235902 -0.018717795157834681702 0.0049581729290314475317 0.095234171770989015093 0.025716484805999771657 -0.26267613247655763331 -0.019871714768955817815 -0.0025237024066975385569 0.057748506333979314487 0.04880504319133299046 -0.18952703381370758495 -0.20945797005138103164 -0.14973016463413435506 -0.044731704355096393866 0.22235826518540155461 -0.073041670537763003779 -0.16615682886780697158 0.15964414855940387006 -0.14481669885936609976 -0.050887420597842361603 -0.30199540264344804097 0.09567686451864149122 0.09728068247784991962 -0.31639202131019394937 -0.19604580060475823577 0.18188505134086474513 -0.35213094972315261977 -0.16429851095461484034 0.0025049150979149217497 0.025866194245098388105 0.019580522977048060024 -0.0059983606367157039224 -0.13719462492256320751 0.14533617087324204875 0.19015187376037803735 0.057962209890543556212 -0.056279641175319729263 0.18904768380363209945 0.15838851517304761152 -0.16321938213710299181 0.060853547917276158696 0.079657968289564826114 0.039606124650497669115 -0.0031134284310009347103 0.16579623836432288986 0.19015661665557376248 0.16485850559745526822 0.074769911142259171122 0.021854540580213525219 0.12713640361470218698 0.24365643342290396745 -0.23538715557658793087 -0.18608944903124655101 0.11986126282635102547 0.16361811906447110143 -0.0072996209637339317874 -0.23713844664573235921 0.12851330192586030154 -0.12395934718009196662 0.13531656048851375962 -0.10388061691146527332 -0.140487370145136653 -0.07125590349105830057 -0.24128099572757205626 0.21579440831216392671 -0.14062266390322289422 -0.22226948547790603694 -0.25659943536738499814 0.11413571474035903719 -0.23096493267649853554 -0.090611334904533907819 -0.25150486193036691862 0.04143329855834128328 0.1898001735943549706;-1.0625900788839783839 0.041299836138465474689 -0.048412542738400426989 -0.27726301435368078119 1.489489102395694875 -2.2966904715511948787 -0.17560933375459675254 -0.1959967571048311652 -0.069450389577193086255 0.93779680350040983683 1.0151301584394523125 0.17958936525404603501 0.12120192504655723231 -0.15756871711884049003 0.95260856217372136268 -1.357970716135867173 -0.53798795879379590623 -0.028557674490990600513 0.30712244133660471235 0.97407474680495931274 0.30933683196454297981 -0.12526000439403278675 -0.50460383756379911802 0.14052820572527932597 -0.13472009148595423533 0.61958200322971990204 -0.066795720786040790884 -0.35783255238947409005 -0.4584708968882474367 -0.8160296656194019338 -0.12862794155221390913 -0.25822282201667751123 0.04392726079861163091 0.28117958461183772956 0.82991677874344660371 -0.1433927320576974529 0.53398914219743542908 -0.29310017032711821461 0.91134992081519516915 -0.13880318760971160907 0.42323272457518412715 -0.36466776511180787335 -0.66232216716850134119 0.35585026447609052758 0.015993457491522752173 0.23467412926871056289 -0.16102126519788859116 0.033132830942191882073 0.083501518471660041154 -0.802697400240058756 -0.74225246634719055372 -0.33542192564562051116 -0.69752772379377414591 0.22260662411618165057 1.4902580053611225175 -0.84496914805550527028 0.1567525278927260346 0.88219968602278342473 0.29353739550276464199 0.72878518412285486772 0.23279457508295894885 0.57396796344822620384 -0.7319851519173046217 -0.46392083575224046799 -0.54052075512078701092 -0.16920508081641114084 0.33894110406156724435 -0.21188037587921679239 -0.90083462946352355072 -1.0130176079962585067 0.25387667992971835185 -0.53123092213217870672 -0.1265951980010539546 0.68171955158199060154 1.3963605158503094028 0.37464936969932649546 -0.0319418817601359456 -0.41316097188558553732 0.80456245574542906152 1.0845663915088534779;0.53104547856561934438 0.50714607786189613847 0.31306508519640874333 0.57484432770066595797 0.55640791703471359497 -0.032580606048439555988 -0.31981491893694591333 -0.18586658086289650771 -0.24426098165416129659 -1.3090119325289142349 0.11862028215992077851 0.30259326038283707039 0.18960767919933813053 0.28160865990652933499 -0.7066738235648437616 0.29445364883574182135 0.16926237243072173033 0.19693827229564764281 0.06119368641156611166 -0.45536719113610113485 0.23202401901418512331 -0.0057730407754785686286 -0.57135848931411881146 -0.41451204603227542744 -0.49296153214564025768 0.35625571267397448949 -0.34200112858051634479 -0.41691554002411718161 0.11900319327663147484 0.47366061432333123049 0.59751614011595810538 -0.34213928995680281675 0.37051789086996711475 0.74203647502789038537 -0.32029456968963870844 0.64161058619298239059 0.60321107464982670621 0.30767794656457864155 0.13865075314978228538 -0.56723037748594129503 -1.0715679019612263101 0.13436955353837581884 -0.17031565074431645468 0.49837546567318075086 0.012345211221681908972 -0.29585283858162236825 0.066304410126437257622 0.63232325383663812168 -0.47175714684370539942 0.2704400082900463298 -0.13519650066943708633 -0.45320603293343897366 0.1499585462739256303 0.66043247271908933627 0.21496887846935766597 0.7549746887488101299 -0.19867182514245110281 -0.091876283123150756516 -0.40921855914545796074 0.060546099410712317379 -0.12340397504249690785 -0.62900570969556568457 -0.4839598589373831361 -0.19752302857587505924 -0.49496447783214003735 -0.55929521271826010409 0.26532217452935380475 -0.11803215826715518499 -0.45502553851044308386 -0.43996832652536188579 0.11260695240214628476 0.10700782635286254507 0.13444268073059431612 0.26001327237171961704 0.59251930088022852772 -0.15505395168607999379 0.031823439323474263241 -0.1197286718110624204 0.81382016406192980718 0.17172667213130579644;1.0087774267739566536 0.019361735890043283576 0.57189698213094197765 0.65694950486169445547 0.11306817406577336638 0.97555206409588657301 0.42234243626544853978 0.25975314941477312125 -0.17251818134088051093 0.8687368768919552231 -0.67891177461362095524 -0.2489884391862676738 -1.3991102423629824258 0.6228313310946484993 0.9417549951864423452 0.53263845698570455589 -0.2377738870921710379 -1.0217463737517402667 -0.0064937936586185766516 0.28600913890752877045 -0.89947431982204650858 -0.23218988493318765132 0.50182579881696387503 0.54391793483976280665 0.97272125181955626516 -0.87169097025112696198 -0.26429092558280375957 0.80010784762588138541 0.33803467912579587829 -0.18530281307992130246 -0.94670702084881575011 0.19962510224449389606 -0.7997030096816026834 -0.15424600882977618221 -0.37847516488079785413 1.0414519617131230422 0.016111099209993866299 -0.016960144186568611169 -1.2330982433791111141 0.14769052175006122662 -1.4418058648603415683 0.29004597151956684753 0.059648293731417195707 -0.52623628345238615545 0.43341590793161088868 -1.215497794280271826 0.073412527414310077556 -0.66608366573495358942 0.5905369192449011484 -0.83832679436042323307 0.42462592290879164203 0.2085931714056568631 0.15718822551971589618 -0.44549895002218037332 -0.62004070839920433222 -0.26367190147986679927 -0.42225853837922777689 -0.54365965705220065107 0.46105520851874587374 1.3901587413954885619 -0.51994913439086953844 0.2139970209395160583 0.32575096495886651793 0.58033921439949620602 0.47481524773961081287 0.43985666538138873394 0.085229934565781956257 0.28685670699435666942 0.11042510291296234182 -0.06381491807837022523 0.95840921225578057374 0.6387540896956891423 0.16447945105147393496 -1.0536801149908001651 -1.8349466134479359702 -0.77839460332512899754 -0.044129361802241792723 0.25009259620871981955 0.61523082628336156485 -0.21690815274403268953;0.27206399085854154896 -0.059610104331070078165 0.15318857545639008588 0.046439457080829728286 -0.13579302265122064619 0.1429169143696308597 -0.59680138794876669284 0.22324884191762306429 -0.21467438619735892957 -0.024605549394583734607 0.63226548592688514017 -0.4160003395958170036 0.16359204420031661642 0.065965632366843163226 -0.094032164900683765096 0.80296451892809361794 -0.90003838044412476371 0.27108757402689981353 -0.32749983104995661343 0.35566304791197406177 -0.16505258981139792063 -0.36055301671765488392 0.27678634126879747557 0.32857206522474441401 0.48824267678777921731 0.24370463250019158696 -0.45651657573094117648 0.094195821660576370404 0.13751460745178054057 0.42432212051580225909 1.2552185292282405094 -0.5287362499230744417 0.19191001375101202076 0.40107736361886842102 0.25011599144777674208 0.63983930993809501331 -0.49753134263343617993 0.41014926942275253818 -0.20564800976811015154 0.23062953066031993687 0.61042313612274701207 -0.27438386719774632283 0.50816033751736744417 0.062130246409750448933 0.32370129991707791151 0.063319910733017459314 0.23427868338078977617 -0.035584878649643596205 -0.26137154720653227313 0.61828617242969763357 0.15038793256941321297 -0.061262483532720596324 0.036755181237016494589 -0.030780310314071818861 0.66211938507114020958 0.25371157294630813928 -0.23208873846382963024 -0.28248586066776909531 0.40272801473400793304 1.1784157555072665158 0.31200568906249337431 -0.28747995192316011526 -0.018748482179394815317 0.2309021432793690598 0.7900335813403803753 -0.26826334245964311709 -0.55266657769852078896 0.40564922086576221671 0.64513469341705143023 0.13798418896755088037 -0.81559844898415723158 -0.29523414003285886054 0.5289211592296574338 0.41208576747939135165 0.10116121798380443841 -0.16984046102248315235 -0.90093635409343297837 0.16478404169274082913 0.36207924974240968119 0.37822639624448234352;-0.51722338003055845501 0.10341839417260069445 0.3382716970005604229 -0.37203352778883458374 0.51866681708911233084 0.17940468384945940095 -0.62331180309370770587 -0.071943552147462078161 -0.12009941221831066382 -0.048750324039929363029 -0.53728129280214664831 -0.55401074209289558059 -0.040887578330464531551 0.26769776022046065656 0.01491241364502951354 -1.0163092767531034522 -1.1569289300867480197 -0.25650473893106084944 -0.57902913687765411588 0.13901412949923089291 0.51060400172017561538 0.1851653820901730807 0.44479215259197774079 0.085878680844823904184 -0.0065959738696921496603 -0.0020175894324043481924 -0.095192177765772073572 0.29005755132936678065 0.48948009407008280514 -0.31678698612722411276 -0.41567619453755383363 -0.3131735980344515502 0.0034257178750964015906 0.50849513106219890179 -0.46608316938674421159 -0.55578432461340199211 -0.50503058165487979547 -0.38291299899754294156 -0.54075534191565000075 -0.56526919385414586827 0.14511162581965705853 0.12411152722887286437 0.91776768183991563888 -0.072201450858744797845 1.2648985561801533439 0.45310715480977231673 0.19742940358061389361 -0.24032451673763008393 -0.26161823643351800328 -0.27431276395475240326 0.21224379819322533591 0.27655855065408907478 -0.060904702784330577714 -0.036197009049257565516 -0.19317251728175383052 0.20220492451693000691 0.37337265032007366239 0.18193611340394108544 1.0987324516763565807 -0.010195896657900098414 -0.22633601742929093659 0.13518703057672448731 0.36486744003537036063 0.23982741346816943695 0.2783128593416504537 0.088676929582296809551 -0.054755512926241346749 0.40271108849135001106 0.54750301308441839954 0.0036068363838485384409 -0.62074715571121352742 0.1492789888462783543 0.13825039673481318014 0.27636703523436284557 -0.49435186422613230928 0.079850626050405854039 0.22226869447944969105 -0.062132560832143350626 0.26045895630880427918 0.12487581499657003647;-0.033783797675347643219 -0.10177932386166353707 -0.28251459874340778544 -0.27350758361170163235 -1.534282324861367508 1.2858287226835931616 0.08385118712501563043 0.84719191510286995239 0.036683195182105575449 -0.081085497067728440346 -1.163252628100988062 0.50338103544846102277 0.62320263247627083469 -0.079960020581128374295 -0.78135199890044959581 0.41455404089575309534 0.91778791348883759227 0.63491817017531970713 -0.025192705056549188208 -2.072084407393381511 0.93013247639088902918 -0.065544753100084646169 0.12824631400867347875 0.22383365391376014442 0.040920104298131740328 0.086620774441631048779 0.078476476316403073752 0.36625307121681766054 -0.35322652612591026733 0.080288974270763313612 0.12644247326549337695 -0.17903747996458665992 -0.2844672502577328399 -0.46265689413528404694 -0.17117330885743170521 -1.1176464673928958593 -0.094011760926272142092 -0.74810778709517200546 -0.72248512143390974938 1.1633188077244656089 0.15408496835670856817 -0.046940531725505114935 0.043573486302796358982 0.070480943338961779543 0.064212764313575212971 0.30400237064602853021 -0.058430210131471406465 -0.57919016831430958359 0.62419741901273129159 -0.070927690134435922298 0.16041175176833055716 0.07104846377363940868 1.1629921395281066498 0.6630775756963638301 -1.5527214920364933448 -0.32392421072619292932 0.23862989139967263896 0.90579902599459294343 0.62062012319328863086 -0.76690936989595581696 -0.59571847022443080721 0.1926608763488750764 -0.013210205690402897216 0.54192662667513324948 0.24890283342724031646 -0.24657087883256703642 -0.2111446023242421477 -0.44055744821830694624 0.074087547461012495664 -0.57964315777744679359 -0.090164277179535567974 0.18716483140656614559 0.0096431562172871569671 -0.33109292427331127318 0.71793145798801538682 0.64623945208343780422 0.5350939389376172528 0.21053541961847155317 -0.8124430038877765714 -1.0382077248575265482;-0.48046001398559334827 0.082222629521282938891 -0.16069740502918500313 -0.0313137529581699256 0.046424381237412527812 -0.23237591878725469274 0.26106509173140235447 -0.29050219361428292197 0.21931701103583076118 0.18450838810414557645 -0.58323452799434372107 -0.22943478612332277033 -0.41584437692648901219 0.3142668335570698579 -0.07133739876343843378 -0.83962143445781800555 0.2190688461259744646 0.29093982786329852797 -0.10089841993575469903 0.95335405111881699192 -0.43207225396208154278 0.60586174591206032325 0.61511193037839007047 0.11926888435480532957 -0.85362972760847999343 -1.1184736171034252994 0.92980230315773471084 0.062387194930834159734 0.55061659458786638144 -0.17416331885165167725 -0.48583777304247977025 0.75082416963653486608 0.041602673369969242478 0.56352428287895139913 -0.44931922073815128149 -0.029795966988640641693 0.24895824430222135426 -0.18291037953222985535 -0.019420529644586691925 -0.58379543371277342612 -0.16129374878526533954 0.0053150610303124047606 -0.20651078376850451335 -0.077212856547442393351 -0.43076889834950410352 -0.19673247522590672776 -0.19152256129568692722 0.42310269927153559832 -0.69435540364854719808 -0.37820849292018288157 -0.076156289350222311496 0.3354104979737396186 -0.27561813456349903984 -0.041120524661643877151 -0.63320280618219271229 0.34677723825523731893 -0.27292159649983122049 -0.0078918998467489478305 -1.2778935371406494603 -0.70885336085086780855 0.22741609578583710238 0.23024926276043347628 0.13574843938919059494 0.34106444373094196854 -0.75124216671921140165 0.1705807346891566878 -0.11310757627385056856 0.30080334336785424787 0.36088993361132826188 0.23251022719954683726 -0.1197633504106653396 0.44035078128165466849 -0.073213836505277726796 -0.0086236734340671000743 -0.95835412564009780922 0.55398810503886597445 0.16598658060920382096 0.46792072912090970638 0.014158557617939085752 -0.33688227373190554603;-0.0030120340925284725363 0.74139161983817059021 -0.38619438063093003421 -0.52213596785903049202 -0.27829490042145965667 -0.088356625596287666213 -0.087055521038823108215 0.34692203067891597135 -0.35015656383491905457 0.09202115393759539852 0.83709349656274556484 0.32005679165686529153 -0.33883083799016244786 -0.1490361000723089413 -0.029117875123833240197 1.0712639810843447297 0.34819079208134418035 0.50906135563763843521 -0.89812238330022520216 -0.16844643563687952681 0.34884821757437728396 0.013885789510887655909 0.037219666963063911813 0.34796722977363558904 0.30824011828770897514 -0.17811020093889001759 -0.039258273992431355626 0.56152616291228651946 -0.19920683579116268969 -1.0202426946742901848 1.0403877520650055555 0.59620566585252432468 -0.85449163253006010788 -0.85278550166321953618 0.35830569476916490634 0.25515974473008951051 1.0010680769475570617 -1.0550256303928899904 0.24853891209158723852 -0.75186069673319377848 0.10389855222335045437 0.047516611179871534598 0.4363924920624154824 -0.15879462690460000029 0.67765234811354857491 -0.08969817105837162019 0.43740789619391884369 -0.54575235831738933001 -0.58126357427360375585 -0.19229624516641566356 -0.15626226097921858127 -0.037653182959736068713 0.60779693065217432757 0.23760297769340538165 0.42994952723139084894 1.0664796385646724275 0.12065960843010303805 1.5654340965163098254 -0.32878300912463187533 0.40413185053195466168 1.4003039158706931389 -0.51705248276904314242 -0.41467752051097306332 0.26043696923135151167 -0.38045262479979002901 0.35494876004583142404 -0.21161547458310867031 -0.66157055457388325159 0.092338704219463899059 0.16214570943261830127 -0.043853104671163836703 -0.058821127391922252425 -0.21779988170039943363 -0.092849627893673583601 -0.0031362574085894989739 -0.012234529860013120678 -0.40490331758456254985 0.81897565080341283572 0.093020442674271744399 0.41717440776036951444;0.59986161004805482744 -0.021913257635062799444 0.28972029896488465939 0.20643110657430110977 0.052922354357575515649 -0.61218027973190280999 -0.68665514654288650753 -0.41311895061532594164 0.015759011728427904653 0.025760291395468482012 0.30659944768320973596 -0.6665542883269082175 -0.49609460589015819121 -0.41059259196188901964 0.39673851421952877061 -0.022571275477848748436 -0.35087588980514400339 -0.978210521614204076 -0.40276153381362161943 1.3316655944630839681 0.23149126541539641333 -0.27492406457923762586 -0.74120755269165528034 -0.28548415683199485082 0.36161706575359597871 -0.45452322624573826548 0.071101543363502994755 -0.11318508902572900487 0.41408566889041742431 -0.56299330853075202352 0.59121479456412273645 -0.30409743152067747474 0.23769201587736452086 0.13319360515507011611 0.50629936046528078997 0.43226007361149237918 -0.21880796839670857423 1.0714878331647799126 -0.85171633802482005215 0.83645010595098512329 -0.074297172219222426537 -0.84436269702018107441 -0.4847322969813270821 0.057489981601516929044 -0.42035145264313644731 -0.020742090582198668969 -0.39595836358593627935 0.034742614238849459096 -0.63666444078933825956 0.13653096120110347345 -0.31341961740534368674 -0.38680269217191998177 -0.22527385580043618463 0.21700975912918965549 1.3270979466490877563 -0.77102391503213574264 -0.10073687637281758533 -0.84389471431646490007 0.53884208543130907021 1.3688140918279152469 -0.68466661251979288316 -0.1391969770565102682 0.082693497974720503452 -0.022293332344994313404 0.49155384948409563961 0.076541987570019565101 -0.14718685971025965986 0.75344814096663037528 -0.21772775032729907441 0.25383601788607068617 0.11725900222644010384 0.074828144176026345491 -0.086671382121868367765 0.55312810375613596925 -0.6828814056440808411 -0.59444281208821425633 -0.064080060558476911736 -0.52522976277075927865 0.43020405361024804947 0.60701294971542785195];

% Layer 2
b2 = [0.33203173441852407155;-0.39095956379642554657;1.0531756831557677057;0.61745322627863219456;0.42795586983825073535;0.72615491062155057556;0.46884416297354486458;-0.40014181081104904791;-0.68267650086049369573];
LW2_1 = [0.5648587800959855576 0.18838803214360677618 -2.7386202509735633193 -3.2791457356790045807 -0.12659490317067570442 1.8641420860857711439 1.0970306384908246056 1.5023008810668514457 -2.2367769693563608335 -0.036100321641738097878;-0.56831127716720952758 3.5292619355867773656 1.9047570461276881471 -1.9690144667437488035 -0.75789293753468400805 -0.97128755525977883423 0.030810111915683051353 0.25029348345446594815 2.4223090203507986473 -3.2564060534472574204;0.87323950601415478712 1.8009186072766265596 -0.87940455996832500585 -1.3503186709665115917 3.337363772141877849 0.094044496846320685401 -2.8176469548557290246 0.17938905167572230526 -1.6028329353269572533 2.2336097058032029494;-0.38002449842757418663 2.3417237450734949 2.5073999820176529063 2.3829563657250463216 -2.0722904556395680409 -1.3119145125822226916 -2.6586524350909752634 2.5524208758462934021 -1.053061370153285381 1.1673797443321576317;-0.6058981986789631069 1.4853174688108896628 0.8932025039913799036 0.38722638166686668137 -0.76670581943360649468 -1.196369060295699116 1.9583538983982080595 -2.6646579908750873678 -3.0532678500230345797 2.1525229903052203184;0.42281421106445221669 -1.370745744508611752 -1.3511803684480208076 3.0477933144936963927 -1.8324462053255676786 0.44532764072548336465 2.1104407576586816653 1.7575620717443012353 1.3058454377974577643 -1.6235849894312959218;-0.2142293422643384293 -3.8051333028341054465 0.74769278611908340793 -0.14158982990973409399 -1.10523357151477164 -1.7334401696286809713 1.7197978261237991671 1.1506682781760948497 -2.2493501678834366686 -1.9660875308227341307;0.3532744859176600305 -0.78463716127691984781 0.99130902680017296547 1.4606799190191031013 2.7616988215846558496 3.0904213822902089071 0.43101835465992932583 -1.0103737666661585237 1.5750051495944639157 0.067845187270080556385;-0.65759721232417034376 -1.1161936448512301823 1.2763956767758486421 1.0430366016653698225 1.2443948476447199702 -2.8892006363030322547 1.2306262062102157895 -1.4220439529146124968 2.659457251747119777 2.0985220665826487263];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
